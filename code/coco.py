import os
import json
import googletrans
from googletrans import Translator
from collections import OrderedDict

def fn():       # 1.Get file names from directory
    file_list=os.listdir(r"/Users/khosrowarian/Desktop/coco/coco/images/selected_images")
    img_names_list = file_list
    return img_names_list


def img_id_to_img_name(img_names_list):
    img_id_to_img_name = {}
    for img_name in img_names_list:
        img_id = img_name.split('.jpg')[0].lstrip('0')
        img_id_to_img_name[img_id] = img_name
    return img_id_to_img_name

def images_to_get():
    images_to_get = '''
000000530820.jpg
000000530836.jpg
000000530854.jpg
000000530975.jpg
000000531036.jpg
000000531134.jpg
000000531135.jpg
000000531495.jpg
000000531707.jpg
000000531771.jpg
000000532058.jpg
000000532071.jpg
000000532129.jpg
000000532481.jpg
000000532493.jpg
000000532530.jpg
000000532575.jpg
000000532690.jpg
000000532761.jpg
000000532855.jpg
000000532901.jpg
000000533145.jpg
000000533206.jpg
000000533493.jpg
000000533536.jpg
000000533816.jpg
000000533855.jpg
000000533958.jpg
000000534041.jpg
000000534270.jpg
000000534394.jpg
000000534601.jpg
000000534605.jpg
000000534639.jpg
000000534664.jpg
000000534673.jpg
000000534827.jpg
000000535094.jpg
000000535156.jpg
000000535253.jpg
000000535306.jpg
000000535523.jpg
000000535578.jpg
000000535608.jpg
000000535858.jpg
000000536038.jpg
000000536073.jpg
000000536343.jpg
000000536947.jpg
000000537053.jpg
000000537153.jpg
000000537241.jpg
000000537270.jpg
000000537355.jpg
000000537506.jpg
000000537672.jpg
000000537802.jpg
000000537812.jpg
000000537827.jpg
000000537964.jpg
000000537991.jpg
000000538067.jpg
000000538236.jpg
000000538364.jpg
000000538458.jpg
000000539143.jpg
000000539445.jpg
000000539883.jpg
000000539962.jpg
000000540280.jpg
000000540414.jpg
000000540466.jpg
000000540502.jpg
000000540928.jpg
000000540932.jpg
000000540962.jpg
000000541055.jpg
000000541123.jpg
000000541291.jpg
000000541634.jpg
000000541664.jpg
000000541773.jpg
000000541952.jpg
000000542073.jpg
000000542089.jpg
000000542127.jpg
000000542423.jpg
000000542625.jpg
000000542776.jpg
000000542856.jpg
000000543043.jpg
000000543047.jpg
000000543300.jpg
000000543528.jpg
000000543581.jpg
000000544052.jpg
000000544306.jpg
000000544444.jpg
000000544519.jpg
000000544565.jpg
000000544605.jpg
000000544811.jpg
000000545007.jpg
000000545100.jpg
000000545129.jpg
000000545219.jpg
000000545407.jpg
000000545594.jpg
000000545730.jpg
000000545826.jpg
000000545958.jpg
000000546011.jpg
000000546219.jpg
000000546325.jpg
000000546475.jpg
000000546556.jpg
000000546626.jpg
000000546659.jpg
000000546717.jpg
000000546823.jpg
000000546826.jpg
000000546829.jpg
000000546964.jpg
000000546976.jpg
000000547144.jpg
000000547336.jpg
000000547383.jpg
000000547502.jpg
000000547519.jpg
000000547816.jpg
000000547854.jpg
000000547886.jpg
000000548246.jpg
000000548267.jpg
000000548339.jpg
000000548506.jpg
000000548524.jpg
000000548555.jpg
000000548780.jpg
000000549055.jpg
000000549136.jpg
000000549167.jpg
000000549220.jpg
000000549390.jpg
000000549674.jpg
000000549738.jpg
000000549930.jpg
000000550084.jpg
000000550322.jpg
000000550349.jpg
000000550426.jpg
000000550471.jpg
000000550691.jpg
000000550714.jpg
000000550797.jpg
000000550939.jpg
000000551215.jpg
000000551304.jpg
000000551350.jpg
000000551439.jpg
000000551660.jpg
000000551780.jpg
000000551794.jpg
000000551804.jpg
000000551815.jpg
000000551820.jpg
000000551822.jpg
000000552371.jpg
000000552612.jpg
000000552775.jpg
000000552842.jpg
000000552883.jpg
000000552902.jpg
000000553094.jpg
000000553221.jpg
000000553339.jpg
000000553511.jpg
000000553664.jpg
000000553669.jpg
000000553731.jpg
000000553776.jpg
000000553788.jpg
000000553990.jpg
000000554002.jpg
000000554156.jpg
000000554266.jpg
000000554291.jpg
000000554328.jpg
000000554579.jpg
000000554595.jpg
000000554735.jpg
000000554838.jpg
000000555005.jpg
000000555009.jpg
000000555012.jpg
000000555050.jpg
000000555412.jpg
000000555597.jpg
000000555705.jpg
000000555972.jpg
000000556000.jpg
000000556158.jpg
000000556193.jpg
000000556498.jpg
000000556765.jpg
000000556873.jpg
000000557172.jpg
000000557258.jpg
000000557501.jpg
000000557672.jpg
000000557884.jpg
000000557916.jpg
000000558073.jpg
000000558114.jpg
000000558213.jpg
000000558421.jpg
000000558558.jpg
000000558854.jpg
000000559099.jpg
000000559160.jpg
000000559348.jpg
000000559513.jpg
000000559543.jpg
000000559547.jpg
000000559707.jpg
000000559842.jpg
000000559956.jpg
000000560011.jpg
000000560178.jpg
000000560256.jpg
000000560266.jpg
000000560279.jpg
000000560312.jpg
000000560371.jpg
000000560474.jpg
000000560880.jpg
000000560911.jpg
000000561009.jpg
000000561223.jpg
000000561256.jpg
000000561335.jpg
000000561366.jpg
000000561465.jpg
000000561679.jpg
000000561889.jpg
000000561958.jpg
000000562059.jpg
000000562121.jpg
000000562197.jpg
000000562207.jpg
000000562229.jpg
000000562243.jpg
000000562443.jpg
000000562448.jpg
000000562561.jpg
000000562581.jpg
000000562818.jpg
000000562843.jpg
000000563267.jpg
000000563281.jpg
000000563349.jpg
000000563470.jpg
000000563603.jpg
000000563604.jpg
000000563648.jpg
000000563653.jpg
000000563702.jpg
000000563758.jpg
000000563882.jpg
000000564023.jpg
000000564091.jpg
000000564127.jpg
000000564133.jpg
000000564280.jpg
000000564336.jpg
000000565012.jpg
000000565045.jpg
000000565153.jpg
000000565391.jpg
000000565469.jpg
000000565563.jpg
000000565597.jpg
000000565607.jpg
000000565624.jpg
000000565776.jpg
000000565778.jpg
000000565853.jpg
000000565877.jpg
000000565962.jpg
000000565989.jpg
000000566042.jpg
000000566282.jpg
000000566436.jpg
000000566524.jpg
000000566758.jpg
000000566923.jpg
000000567011.jpg
000000567197.jpg
000000567432.jpg
000000567640.jpg
000000567740.jpg
000000567825.jpg
000000567886.jpg
000000567898.jpg
000000568147.jpg
000000568195.jpg
000000568213.jpg
000000568290.jpg
000000568439.jpg
000000568584.jpg
000000568690.jpg
000000568710.jpg
000000568814.jpg
000000568981.jpg
000000569030.jpg
000000569059.jpg
000000569273.jpg
000000569565.jpg
000000569700.jpg
000000569825.jpg
000000569917.jpg
000000569972.jpg
000000569976.jpg
000000570169.jpg
000000570448.jpg
000000570456.jpg
000000570471.jpg
000000570539.jpg
000000570664.jpg
000000570688.jpg
000000570736.jpg
000000570756.jpg
000000570782.jpg
000000570834.jpg
000000571008.jpg
000000571264.jpg
000000571313.jpg
000000571598.jpg
000000571718.jpg
000000571804.jpg
000000571857.jpg
000000571893.jpg
000000571943.jpg
000000572303.jpg
000000572388.jpg
000000572408.jpg
000000572462.jpg
000000572517.jpg
000000572555.jpg
000000572620.jpg
000000572678.jpg
000000572900.jpg
000000572956.jpg
000000573008.jpg
000000573094.jpg
000000573258.jpg
000000573391.jpg
000000573626.jpg
000000573943.jpg
000000574297.jpg
000000574315.jpg
000000574425.jpg
000000574520.jpg
000000574702.jpg
000000574810.jpg
000000574823.jpg
000000575081.jpg
000000575187.jpg
000000575205.jpg
000000575243.jpg
000000575357.jpg
000000575372.jpg
000000575500.jpg
000000575815.jpg
000000575970.jpg
000000576031.jpg
000000576052.jpg
000000576566.jpg
000000576654.jpg
000000576955.jpg
000000577149.jpg
000000577182.jpg
000000577539.jpg
000000577584.jpg
000000577735.jpg
000000577862.jpg
000000577864.jpg
000000577932.jpg
000000577959.jpg
000000577976.jpg
000000578093.jpg
000000578236.jpg
000000578489.jpg
000000578500.jpg
000000578545.jpg
000000578792.jpg
000000578871.jpg
000000578922.jpg
000000578967.jpg
000000579070.jpg
000000579091.jpg
000000579158.jpg
000000579307.jpg
000000579321.jpg
000000579635.jpg
000000579655.jpg
000000579818.jpg
000000579893.jpg
000000579900.jpg
000000579902.jpg
000000579970.jpg
000000580197.jpg
000000580294.jpg
000000580410.jpg
000000580418.jpg
000000580757.jpg
000000581062.jpg
000000581100.jpg
000000581206.jpg
000000581317.jpg
000000581357.jpg
000000581482.jpg
000000581615.jpg
000000581781.jpg'''
    image_set = set(images_to_get.split('\n'))
    return image_set

def img_name_to_caption(img_names_list, img_id_to_img_name):
    translator = Translator()
    img_name_to_caption = {}

    img_names_set = set(list(map(lambda img_name: img_name.split('.jpg')[0].lstrip('0'), img_names_list)))

    with open('/Users/khosrowarian/Desktop/coco/coco/annotations/captions_val2017.json') as json_file:
        data = json.load(json_file)
    annotations_list = data['annotations']

    count = 0
    images_to = images_to_get()
    for obj in annotations_list:
        if count >= 350:
            break
        if str(obj['image_id']) in img_names_set:
            if img_id_to_img_name[str(obj['image_id'])] not in images_to:
                continue
            caption = obj['caption']
            
            caption = translator.translate(caption, src = 'en', dest = 'ar').text
            if img_id_to_img_name[str(obj['image_id'])] in img_name_to_caption:
                if caption not in img_name_to_caption[img_id_to_img_name[str(obj['image_id'])]]:
                    img_name_to_caption[img_id_to_img_name[str(obj['image_id'])]].append(caption)
            else:
                img_name_to_caption[img_id_to_img_name[str(obj['image_id'])]] = [caption]
            count += 1

    return img_name_to_caption

img_names_list = fn()
img_id_to_img_name = img_id_to_img_name(img_names_list)
image_name_to_caption = img_name_to_caption(img_names_list, img_id_to_img_name)

def get_coco_data():
    return image_name_to_caption
